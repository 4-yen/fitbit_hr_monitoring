<!DOCTYPE html>
<html>
<head>
    <title>PKCE Challenge Verifier</title>
</head>
<body>
    <h1>PKCE Challenge Verifier</h1>
    <p>Step Bで控えた code_verifier を入力してください:</p>
    <input type="text" id="verifier" size="50">
    <button onclick="generate()">Generate Challenge</button>
    <p>生成された Code Challenge:</p>
    <pre id="challenge"></pre>
    <script>
        async function generate() {
            const verifier = document.getElementById('verifier').value;
            const encoder = new TextEncoder();
            const data = encoder.encode(verifier);
            const digest = await window.crypto.subtle.digest('SHA-256', data);
            const base64Url = btoa(String.fromCharCode(...new Uint8Array(digest)))
                .replace(/\+/g, '-')
                .replace(/\//g, '_')
                .replace(/=/g, '');
            document.getElementById('challenge').textContent = base64Url;
        }
    </script>
</body>
</html>